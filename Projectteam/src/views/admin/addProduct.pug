extends ../layout

block content
  section(style="max-width: 800px; margin: 50px auto; background: white; padding: 40px; border-radius: 12px; box-shadow: 0 2px 10px rgba(0,0,0,0.1); font-family: Arial, sans-serif;")
    h1(style="text-align:center; margin-bottom: 30px; font-size: 2rem; color:#333;") Add New Products

    form(action="/products/multiple" method="POST" id="productForm" style="display:flex; flex-direction:column; gap:30px;")

      #productContainer
        .product-group(style="border:1px solid #ddd; padding:20px; border-radius:10px; margin-bottom:10px; background:#fafafa;")
          h3(style="margin-bottom:15px; color:#222;") Product 1
          .field-group(style="display:grid; grid-template-columns: 1fr 1fr; gap:15px;")
            .input-field
              label(for="name0" style="display:block; font-weight:bold; margin-bottom:5px;") Name:
              input(type="text" id="name0" name="products[0][name]" required placeholder="Name of product" style="width:100%; padding:8px; border:1px solid #ccc; border-radius:5px;")
            .input-field
              label(for="price0" style="display:block; font-weight:bold; margin-bottom:5px;") Price (€):
              input(type="number" id="price0" name="products[0][price]" step="0.01" required placeholder="0.00" style="width:100%; padding:8px; border:1px solid #ccc; border-radius:5px;")
          .field-group(style="display:grid; grid-template-columns: 1fr 1fr; gap:15px; margin-top:10px;")
            .input-field
              label(for="stock0" style="display:block; font-weight:bold; margin-bottom:5px;") Stock:
              input(type="number" id="stock0" name="products[0][stock]" min="0" required placeholder="Stock quantity" style="width:100%; padding:8px; border:1px solid #ccc; border-radius:5px;")
            .input-field
              label(for="categoryId0" style="display:block; font-weight:bold; margin-bottom:5px;") Category:
              select(name="products[0][categoryId]" id="categoryId0" required style="width:100%; padding:8px; border:1px solid #ccc; border-radius:5px; background:white;")
                option(value="") -- Select a category --
                each category in categories
                  option(value=category.id)= category.name

      // Add another product
      button(type="button" id="addProductBtn" style="padding:12px; background:#28a745; color:white; border:none; border-radius:6px; cursor:pointer; font-size:1rem; font-weight:bold; transition: background 0.2s;")
        | + Add another product

      // Submit all products
      button(type="submit" style="padding:12px; background:#222; color:white; border:none; border-radius:6px; cursor:pointer; font-size:1rem; font-weight:bold; transition: background 0.2s;")
        | Save All Products

      a(href="/admin" style="text-align:center; margin-top:15px; display:block; color:#333; text-decoration:none; font-size:0.95rem;")
        | Back to dashboard

  script.
    let productCount = 1;
    document.getElementById('addProductBtn').addEventListener('click', () => {
      const container = document.getElementById('productContainer');
      const newDiv = document.createElement('div');
      newDiv.classList.add('product-group');
      newDiv.style = "border:1px solid #ddd; padding:20px; border-radius:10px; margin-bottom:10px; background:#fafafa;";
      newDiv.innerHTML = `
        <h3 style="margin-bottom:15px; color:#222;">Product ${productCount + 1}</h3>
        <div style='display:grid; grid-template-columns: 1fr 1fr; gap:15px;'>
          <div>
            <label style='display:block; font-weight:bold; margin-bottom:5px;'>Name:</label>
            <input type='text' name='products[${productCount}][name]' required placeholder='Name of product' style='width:100%; padding:8px; border:1px solid #ccc; border-radius:5px;'>
          </div>
          <div>
            <label style='display:block; font-weight:bold; margin-bottom:5px;'>Price (€):</label>
            <input type='number' step='0.01' name='products[${productCount}][price]' required placeholder='0.00' style='width:100%; padding:8px; border:1px solid #ccc; border-radius:5px;'>
          </div>
        </div>
        <div style='display:grid; grid-template-columns: 1fr 1fr; gap:15px; margin-top:10px;'>
          <div>
            <label style='display:block; font-weight:bold; margin-bottom:5px;'>Stock:</label>
            <input type='number' min='0' name='products[${productCount}][stock]' required placeholder='Stock quantity' style='width:100%; padding:8px; border:1px solid #ccc; border-radius:5px;'>
          </div>
          <div>
            <label style='display:block; font-weight:bold; margin-bottom:5px;'>Category:</label>
            <select name='products[${productCount}][categoryId]' required style='width:100%; padding:8px; border:1px solid #ccc; border-radius:5px; background:white;'>
              <option value=''>-- Select a category --</option>
              ${Array.from(document.querySelectorAll('#categoryId0 option'))
                .map(opt => `<option value='${opt.value}'>${opt.textContent}</option>`)
                .join('')}
            </select>
          </div>
        </div>
      `;
      container.appendChild(newDiv);
      productCount++;
    });
